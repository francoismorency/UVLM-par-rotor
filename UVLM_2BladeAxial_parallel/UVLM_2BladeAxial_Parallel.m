% ===========================
%% WAKE ROLLUP CALCULATION %%
% ===========================
IW=1;
if IT~=1
    if IT >=NW
        IW=IT-NW+1;
    end
    I1=IT-1;
    JS1=0;
    JS2=0;
    for I=IW:I1
        for J=1:JB1
            [U,V,W]  = F_Wake_Rollup(QW(I,J,1),QW(I,J,2),QW(I,J,3),IT,QW,QWA,VORTIC,GAMA,CH,IB,JB,T,Blade_1_QF,Blade_2_QF,Wake_Age);

            UVW(I,J,1)=U*DT;    UVW(I,J,2)=V*DT;    UVW(I,J,3)=W*DT;
        end
    end
    for  I=IW:I1
        for J=1:JB1

            QW(I,J,1)=QW(I,J,1)+UVW(I,J,1);     QW(I,J,2)=QW(I,J,2)+UVW(I,J,2);     QW(I,J,3)=QW(I,J,3)+UVW(I,J,3);
            [QWA(I,J,1),QWA(I,J,2)]=F_Rotate_1(QW(I,J,1),QW(I,J,2),180);   QWA(I,J,3)=QW(I,J,3);
        end
    end
end

%% Function Geo
function [QC,QF,QCA,QFA,S,AR,ZAngle,XAngle,DS,SS,PanelAreas]=F_Geo(B,C,IB,JB,ALFA,DXW,RootY,RootX,BB,CH1,AirfoilShape)

if AirfoilShape==1;
    XU=[1,0.999842095,0.999368478,0.99857945,0.997475508,0.996057351,0.994325872,0.992282167,0.989927526,0.987263436,0.984291581,0.981013836,0.977432272,0.973549152,0.969366929,0.964888243,0.960115924,0.955052985,0.949702626,0.944068224,0.93815334,0.931961709,0.925497241,0.91876402,0.911766299,0.904508497,0.896995199,0.889231151,0.881221256,0.872970573,0.864484314,0.855767839,0.846826653,0.837666404,0.828292878,0.818711995,0.808929807,0.798952492,0.788786352,0.778437808,0.767913397,0.757219767,0.746363671,0.735351966,0.724191608,0.712889646,0.701453218,0.689889548,0.678205939,0.666409772,0.654508497,0.642509631,0.630420753,0.618249499,0.606003555,0.593690657,0.581318583,0.568895145,0.556428192,0.543925598,0.53139526,0.518845091,0.50628302,0.49371698,0.481154909,0.46860474,0.456074402,0.443571808,0.431104855,0.418681417,0.406309343,0.393996445,0.381750501,0.369579247,0.357490369,0.345491503,0.333590228,0.321794061,0.310110452,0.298546782,0.287110354,0.275808392,0.264648034,0.253636329,0.242780233,0.232086603,0.221562192,0.211213648,0.201047508,0.191070193,0.181288005,0.171707122,0.162333596,0.153173347,0.144232161,0.135515686,0.127029427,0.118778744,0.110768849,0.103004801,0.095491503,0.088233701,0.08123598,0.074502759,0.068038291,0.06184666,0.055931776,0.050297374,0.044947015,0.039884076,0.035111757,0.030633071,0.026450848,0.022567728,0.018986164,0.015708419,0.012736564,0.010072474,0.007717833,0.005674128,0.003942649,0.002524492,0.00142055,0.000631522,0.000157905,0];
    YU=[0,2.35E-05,9.22E-05,0.00020467,0.000360839,0.000560948,0.000805096,0.001092056,0.001421714,0.001793546,0.002206919,0.002661122,0.003155396,0.003688901,0.004260727,0.004869917,0.005515504,0.006196423,0.006911551,0.00765976,0.008439967,0.009250932,0.010091355,0.010959996,0.011855644,0.012776974,0.013722634,0.014691309,0.015681669,0.016692332,0.017721891,0.01876898,0.019832196,0.020910155,0.022001439,0.023104684,0.024218454,0.025341246,0.026471603,0.027608156,0.028749462,0.029894028,0.031040371,0.032186951,0.033332284,0.034474834,0.035613073,0.036745384,0.037870234,0.038986035,0.040091154,0.04118392,0.042262636,0.043325649,0.044371175,0.045397565,0.046402925,0.047385613,0.048343697,0.049275561,0.05017914,0.051052807,0.051894479,0.052702554,0.053474934,0.054210021,0.054905729,0.055560474,0.05617224,0.056739442,0.057260151,0.057732795,0.05815559,0.058527023,0.058845495,0.059109531,0.05931769,0.059468597,0.059561011,0.05959372,0.059565685,0.059475895,0.059323502,0.059107713,0.058827898,0.05848353,0.058074226,0.057599716,0.05705987,0.056454687,0.055784313,0.055049034,0.05424927,0.05338558,0.052458652,0.051469305,0.050418485,0.049307255,0.048136792,0.046908376,0.04562338,0.04428326,0.042889543,0.041443815,0.039947707,0.038402883,0.036811027,0.035173828,0.033492969,0.031770117,0.030006917,0.028204995,0.026365963,0.024491442,0.022583092,0.020642655,0.018672004,0.016673195,0.014648511,0.012600503,0.010532006,0.008446144,0.006346308,0.004236121,0.002119382,0];
    XL=[0,0.000157905,0.000631522,0.00142055,0.002524492,0.003942649,0.005674128,0.007717833,0.010072474,0.012736564,0.015708419,0.018986164,0.022567728,0.026450848,0.030633071,0.035111757,0.039884076,0.044947015,0.050297374,0.055931776,0.06184666,0.068038291,0.074502759,0.08123598,0.088233701,0.095491503,0.103004801,0.110768849,0.118778744,0.127029427,0.135515686,0.144232161,0.153173347,0.162333596,0.171707122,0.181288005,0.191070193,0.201047508,0.211213648,0.221562192,0.232086603,0.242780233,0.253636329,0.264648034,0.275808392,0.287110354,0.298546782,0.310110452,0.321794061,0.333590228,0.345491503,0.357490369,0.369579247,0.381750501,0.393996445,0.406309343,0.418681417,0.431104855,0.443571808,0.456074402,0.46860474,0.481154909,0.49371698,0.50628302,0.518845091,0.53139526,0.543925598,0.556428192,0.568895145,0.581318583,0.593690657,0.606003555,0.618249499,0.630420753,0.642509631,0.654508497,0.666409772,0.678205939,0.689889548,0.701453218,0.712889646,0.724191608,0.735351966,0.746363671,0.757219767,0.767913397,0.778437808,0.788786352,0.798952492,0.808929807,0.818711995,0.828292878,0.837666404,0.846826653,0.855767839,0.864484314,0.872970573,0.881221256,0.889231151,0.896995199,0.904508497,0.911766299,0.91876402,0.925497241,0.931961709,0.93815334,0.944068224,0.949702626,0.955052985,0.960115924,0.964888243,0.969366929,0.973549152,0.977432272,0.981013836,0.984291581,0.987263436,0.989927526,0.992282167,0.994325872,0.996057351,0.997475508,0.99857945,0.999368478,0.999842095,1];
    YL=[0,-0.002130708,-0.004256204,-0.006372727,-0.00847674,-0.010564967,-0.012634404,-0.014682313,-0.016706213,-0.018703842,-0.020673132,-0.022612165,-0.024519139,-0.026392332,-0.02823007,-0.030030707,-0.031792599,-0.033514101,-0.035193555,-0.03682929,-0.038419631,-0.039962898,-0.041457425,-0.042901564,-0.044293701,-0.045632267,-0.046915751,-0.048142712,-0.049311791,-0.050421721,-0.051471335,-0.052459578,-0.053385511,-0.054248319,-0.055047316,-0.055781944,-0.05645178,-0.057056533,-0.057596054,-0.058070335,-0.0584795,-0.058823809,-0.059103634,-0.059319493,-0.059472009,-0.05956196,-0.059590191,-0.059557697,-0.059465518,-0.059314852,-0.059106938,-0.058843145,-0.058524908,-0.058153703,-0.057731117,-0.057258677,-0.056738148,-0.056171118,-0.0555595,-0.054904896,-0.054209305,-0.053474329,-0.05270204,-0.051894049,-0.051052445,-0.05017884,-0.049275311,-0.048343493,-0.047385444,-0.046402788,-0.045397453,-0.044371085,-0.043325576,-0.042262578,-0.041183875,-0.040091118,-0.038986007,-0.037870213,-0.036745368,-0.035613061,-0.034474826,-0.03333228,-0.032186949,-0.031040371,-0.029894029,-0.028749465,-0.02760816,-0.026471608,-0.025341252,-0.02421846,-0.023104691,-0.022001446,-0.020910163,-0.019832204,-0.018768989,-0.0177219,-0.016692342,-0.015681679,-0.014691319,-0.013722643,-0.012776983,-0.011855654,-0.010960005,-0.010091364,-0.009250941,-0.008439976,-0.007659769,-0.006911559,-0.006196431,-0.005515511,-0.004869924,-0.004260733,-0.003688907,-0.003155401,-0.002661126,-0.002206922,-0.001793548,-0.001421716,-0.001092057,-0.000805097,-0.000560948,-0.00036084,-0.000204671,-9.22E-05,-2.35E-05,0];
elseif AirfoilShape==2;
    XU=[1,0.999842095,0.999368478,0.99857945,0.997475508,0.996057351,0.994325872,0.992282167,0.989927526,0.987263436,0.984291581,0.981013836,0.977432272,0.973549152,0.969366929,0.964888243,0.960115924,0.955052985,0.949702626,0.944068224,0.93815334,0.931961709,0.925497241,0.91876402,0.911766299,0.904508497,0.896995199,0.889231151,0.881221256,0.872970573,0.864484314,0.855767839,0.846826653,0.837666404,0.828292878,0.818711995,0.808929807,0.798952492,0.788786352,0.778437808,0.767913397,0.757219767,0.746363671,0.735351966,0.724191608,0.712889646,0.701453218,0.689889548,0.678205939,0.666409772,0.654508497,0.642509631,0.630420753,0.618249499,0.606003555,0.593690657,0.581318583,0.568895145,0.556428192,0.543925598,0.53139526,0.518845091,0.50628302,0.49371698,0.481154909,0.46860474,0.456074402,0.443571808,0.431104855,0.418681417,0.406309343,0.393996445,0.381750501,0.369579247,0.357490369,0.345491503,0.333590228,0.321794061,0.310110452,0.298546782,0.287110354,0.275808392,0.264648034,0.253636329,0.242780233,0.232086603,0.221562192,0.211213648,0.201047508,0.191070193,0.181288005,0.171707122,0.162333596,0.153173347,0.144232161,0.135515686,0.127029427,0.118778744,0.110768849,0.103004801,0.095491503,0.088233701,0.08123598,0.074502759,0.068038291,0.06184666,0.055931776,0.050297374,0.044947015,0.039884076,0.035111757,0.030633071,0.026450848,0.022567728,0.018986164,0.015708419,0.012736564,0.010072474,0.007717833,0.005674128,0.003942649,0.002524492,0.00142055,0.000631522,0.000157905,0];
    YU=[0,5.66E-05,0.000217141,0.000475033,0.000828571,0.001278288,0.001825342,0.002463489,0.003193295,0.004012113,0.004916956,0.005904498,0.00697109,0.008112786,0.009325354,0.010604299,0.011944877,0.013342112,0.014790815,0.016285605,0.017820934,0.019391297,0.020992923,0.02263108,0.024314662,0.026043149,0.027813847,0.029623768,0.031469866,0.033349052,0.035258202,0.037194088,0.039152773,0.041127857,0.043114531,0.045109086,0.047107991,0.049107759,0.051104943,0.053096139,0.055078001,0.057047322,0.059001728,0.060941979,0.06286683,0.064773709,0.066659938,0.06852291,0.0703601,0.072169055,0.073947094,0.07568917,0.07738611,0.079034065,0.080630759,0.082174217,0.083662626,0.085094322,0.086467774,0.087781433,0.089033497,0.090222701,0.09134811,0.092408973,0.093404698,0.094334745,0.095197569,0.095985218,0.096678044,0.097269585,0.097759524,0.09814884,0.098438853,0.098630972,0.098725542,0.098717316,0.098591235,0.09834134,0.09796888,0.097477232,0.096870023,0.096149742,0.095316398,0.094370269,0.09331466,0.092153928,0.090891565,0.089530131,0.088073498,0.086526488,0.08489268,0.083172753,0.08136616,0.079475109,0.077505175,0.075463682,0.073358167,0.071195793,0.068983315,0.066726601,0.06442965,0.062094304,0.05972144,0.057312766,0.054871881,0.052404205,0.049916188,0.047414174,0.044903264,0.042386535,0.039864771,0.037336651,0.034799527,0.032251067,0.029691549,0.02712567,0.024561993,0.02200875,0.019466546,0.016921162,0.014341462,0.011686393,0.008920546,0.006031769,0.003041302,0];
    XL=[0,0.000157905,0.000631522,0.00142055,0.002524492,0.003942649,0.005674128,0.007717833,0.010072474,0.012736564,0.015708419,0.018986164,0.022567728,0.026450848,0.030633071,0.035111757,0.039884076,0.044947015,0.050297374,0.055931776,0.06184666,0.068038291,0.074502759,0.08123598,0.088233701,0.095491503,0.103004801,0.110768849,0.118778744,0.127029427,0.135515686,0.144232161,0.153173347,0.162333596,0.171707122,0.181288005,0.191070193,0.201047508,0.211213648,0.221562192,0.232086603,0.242780233,0.253636329,0.264648034,0.275808392,0.287110354,0.298546782,0.310110452,0.321794061,0.333590228,0.345491503,0.357490369,0.369579247,0.381750501,0.393996445,0.406309343,0.418681417,0.431104855,0.443571808,0.456074402,0.46860474,0.481154909,0.49371698,0.50628302,0.518845091,0.53139526,0.543925598,0.556428192,0.568895145,0.581318583,0.593690657,0.606003555,0.618249499,0.630420753,0.642509631,0.654508497,0.666409772,0.678205939,0.689889548,0.701453218,0.712889646,0.724191608,0.735351966,0.746363671,0.757219767,0.767913397,0.778437808,0.788786352,0.798952492,0.808929807,0.818711995,0.828292878,0.837666404,0.846826653,0.855767839,0.864484314,0.872970573,0.881221256,0.889231151,0.896995199,0.904508497,0.911766299,0.91876402,0.925497241,0.931961709,0.93815334,0.944068224,0.949702626,0.955052985,0.960115924,0.964888243,0.969366929,0.973549152,0.977432272,0.981013836,0.984291581,0.987263436,0.989927526,0.992282167,0.994325872,0.996057351,0.997475508,0.99857945,0.999368478,0.999842095,1];
    YL=[0,-0.001463181,-0.002946071,-0.004457783,-0.006000719,-0.007570335,-0.009156025,-0.010742811,-0.012313432,-0.013850453,-0.015338041,-0.016763178,-0.018116182,-0.019390606,-0.020582664,-0.02169045,-0.022713194,-0.023650744,-0.024503389,-0.025271959,-0.025958041,-0.026564071,-0.027093148,-0.027548577,-0.027933299,-0.028249458,-0.028498291,-0.028680508,-0.028797126,-0.028850373,-0.028843837,-0.028781431,-0.028665903,-0.028498229,-0.028278258,-0.028005817,-0.02768112,-0.027304303,-0.026875931,-0.026399876,-0.025887601,-0.025357129,-0.024820999,-0.024284266,-0.02374774,-0.023209434,-0.022667074,-0.02212006,-0.021568586,-0.021013063,-0.020454289,-0.019895057,-0.019341581,-0.018796218,-0.018259787,-0.017732862,-0.017215969,-0.016709594,-0.016214024,-0.015727235,-0.015238804,-0.014746206,-0.014249552,-0.013749143,-0.013245295,-0.012738335,-0.012228668,-0.011718431,-0.011216369,-0.010724394,-0.01024278,-0.009771721,-0.009311387,-0.008861927,-0.008423485,-0.007996718,-0.007585936,-0.007192314,-0.006815767,-0.006456135,-0.006113227,-0.005786824,-0.005476676,-0.005182489,-0.004903587,-0.004638592,-0.004387099,-0.004148808,-0.003923404,-0.003710558,-0.003509924,-0.003321146,-0.003143853,-0.002977708,-0.002823039,-0.002681403,-0.002552472,-0.002435615,-0.002330181,-0.002235515,-0.002150966,-0.002075883,-0.002009559,-0.001950064,-0.001884249,-0.001803682,-0.001709802,-0.001604955,-0.001491465,-0.001371576,-0.001247444,-0.00112113,-0.000994592,-0.000869682,-0.000748136,-0.000631575,-0.000521491,-0.00041925,-0.000326081,-0.000243078,-0.000170231,-0.00011022,-6.29E-05,-2.85E-05,-7.33E-06,0];
elseif AirfoilShape==3;
    XU=[1,0.999842095,0.999368478,0.99857945,0.997475508,0.996057351,0.994325872,0.992282167,0.989927526,0.987263436,0.984291581,0.981013836,0.977432272,0.973549152,0.969366929,0.964888243,0.960115924,0.955052985,0.949702626,0.944068224,0.93815334,0.931961709,0.925497241,0.91876402,0.911766299,0.904508497,0.896995199,0.889231151,0.881221256,0.872970573,0.864484314,0.855767839,0.846826653,0.837666404,0.828292878,0.818711995,0.808929807,0.798952492,0.788786352,0.778437808,0.767913397,0.757219767,0.746363671,0.735351966,0.724191608,0.712889646,0.701453218,0.689889548,0.678205939,0.666409772,0.654508497,0.642509631,0.630420753,0.618249499,0.606003555,0.593690657,0.581318583,0.568895145,0.556428192,0.543925598,0.53139526,0.518845091,0.50628302,0.49371698,0.481154909,0.46860474,0.456074402,0.443571808,0.431104855,0.418681417,0.406309343,0.393996445,0.381750501,0.369579247,0.357490369,0.345491503,0.333590228,0.321794061,0.310110452,0.298546782,0.287110354,0.275808392,0.264648034,0.253636329,0.242780233,0.232086603,0.221562192,0.211213648,0.201047508,0.191070193,0.181288005,0.171707122,0.162333596,0.153173347,0.144232161,0.135515686,0.127029427,0.118778744,0.110768849,0.103004801,0.095491503,0.088233701,0.08123598,0.074502759,0.068038291,0.06184666,0.055931776,0.050297374,0.044947015,0.039884076,0.035111757,0.030633071,0.026450848,0.022567728,0.018986164,0.015708419,0.012736564,0.010072474,0.007717833,0.005674128,0.003942649,0.002524492,0.00142055,0.000631522,0.000157905,0];
    YU=[0,2.84E-05,0.000113702,0.000255693,0.000454226,0.000709046,0.001019829,0.001386177,0.001807624,0.002283632,0.002813598,0.003396849,0.004032648,0.004720193,0.005458617,0.006246997,0.007084345,0.007969618,0.008901719,0.009879494,0.010901742,0.01196721,0.013074598,0.014228185,0.015433597,0.016690825,0.017999839,0.01936059,0.020773009,0.022236394,0.023741523,0.025284397,0.026863797,0.028478481,0.030127186,0.031807418,0.033514626,0.035247058,0.037003111,0.038781173,0.040576815,0.042381414,0.044192609,0.046008356,0.047826518,0.04963872,0.051439087,0.053225375,0.054995403,0.05674337,0.058459419,0.060141086,0.061786252,0.063391331,0.064948113,0.066454054,0.067907395,0.069303994,0.070628717,0.071878104,0.073050914,0.074147901,0.075178854,0.076144826,0.077045285,0.077875105,0.078605183,0.079230862,0.079752655,0.080171134,0.080485917,0.080697953,0.0808087,0.080819197,0.080724149,0.080523856,0.080220869,0.079818001,0.079319195,0.078728126,0.078048141,0.077282799,0.076434288,0.075502981,0.074492981,0.073408728,0.072254782,0.07103144,0.069740939,0.06838862,0.066979966,0.065520523,0.064004345,0.06242939,0.060802712,0.059131473,0.057422921,0.055681848,0.05389455,0.052065351,0.050203759,0.048319326,0.046417409,0.044482578,0.042522815,0.040550732,0.038570548,0.036566341,0.034551962,0.032544058,0.030559116,0.028580166,0.026584698,0.024598799,0.022648892,0.020758106,0.01885484,0.016934694,0.015048535,0.013203976,0.011418831,0.009533874,0.007575676,0.005727334,0.00420566,0];
    XL=[0,0.000157905,0.000631522,0.00142055,0.002524492,0.003942649,0.005674128,0.007717833,0.010072474,0.012736564,0.015708419,0.018986164,0.022567728,0.026450848,0.030633071,0.035111757,0.039884076,0.044947015,0.050297374,0.055931776,0.06184666,0.068038291,0.074502759,0.08123598,0.088233701,0.095491503,0.103004801,0.110768849,0.118778744,0.127029427,0.135515686,0.144232161,0.153173347,0.162333596,0.171707122,0.181288005,0.191070193,0.201047508,0.211213648,0.221562192,0.232086603,0.242780233,0.253636329,0.264648034,0.275808392,0.287110354,0.298546782,0.310110452,0.321794061,0.333590228,0.345491503,0.357490369,0.369579247,0.381750501,0.393996445,0.406309343,0.418681417,0.431104855,0.443571808,0.456074402,0.46860474,0.481154909,0.49371698,0.50628302,0.518845091,0.53139526,0.543925598,0.556428192,0.568895145,0.581318583,0.593690657,0.606003555,0.618249499,0.630420753,0.642509631,0.654508497,0.666409772,0.678205939,0.689889548,0.701453218,0.712889646,0.724191608,0.735351966,0.746363671,0.757219767,0.767913397,0.778437808,0.788786352,0.798952492,0.808929807,0.818711995,0.828292878,0.837666404,0.846826653,0.855767839,0.864484314,0.872970573,0.881221256,0.889231151,0.896995199,0.904508497,0.911766299,0.91876402,0.925497241,0.931961709,0.93815334,0.944068224,0.949702626,0.955052985,0.960115924,0.964888243,0.969366929,0.973549152,0.977432272,0.981013836,0.984291581,0.987263436,0.989927526,0.992282167,0.994325872,0.996057351,0.997475508,0.99857945,0.999368478,0.999842095,1];
    YL=[0,-0.000689312,-0.002022771,-0.003473467,-0.004921275,-0.006426604,-0.007971213,-0.009441517,-0.010806185,-0.012103248,-0.013367872,-0.014588599,-0.015737985,-0.016883884,-0.01802752,-0.019149755,-0.020230874,-0.021286022,-0.022340803,-0.023385049,-0.024408295,-0.025402231,-0.026375013,-0.027322019,-0.028234918,-0.029112948,-0.029970481,-0.030803169,-0.031605398,-0.032371541,-0.033105524,-0.033815834,-0.034498693,-0.035150275,-0.035766784,-0.036344982,-0.036886137,-0.037388178,-0.037847915,-0.038262232,-0.038628985,-0.038951515,-0.039228497,-0.039457539,-0.039636349,-0.039761998,-0.039831327,-0.039842293,-0.039792984,-0.039680612,-0.039499477,-0.039247519,-0.038923238,-0.03852638,-0.03806297,-0.037533461,-0.036937166,-0.036274695,-0.035554311,-0.034777671,-0.033944809,-0.033057161,-0.032123429,-0.031145619,-0.030124313,-0.02906155,-0.027965546,-0.026838295,-0.02568074,-0.02449951,-0.023323834,-0.022158333,-0.021003673,-0.01985385,-0.018670019,-0.017447229,-0.01618731,-0.014896579,-0.013630784,-0.012406235,-0.011222785,-0.010080218,-0.008975075,-0.007904096,-0.006867146,-0.005864047,-0.004895848,-0.003973165,-0.003097555,-0.002267876,-0.001482935,-0.0007428,-5.65E-05,0.000575772,0.001156406,0.001687728,0.002172113,0.00259807,0.002944104,0.003215563,0.003418367,0.003558387,0.003641429,0.003673103,0.003651213,0.003577542,0.003458953,0.003302134,0.003113578,0.002899557,0.002666107,0.002419005,0.002163749,0.00190554,0.001649268,0.001399491,0.001160426,0.000935929,0.000729484,0.000544195,0.000382773,0.000247525,0.00014035,6.27E-05,1.57E-05,0];
elseif AirfoilShape==4;
    XU=[1,0.999842095,0.999368478,0.99857945,0.997475508,0.996057351,0.994325872,0.992282167,0.989927526,0.987263436,0.984291581,0.981013836,0.977432272,0.973549152,0.969366929,0.964888243,0.960115924,0.955052985,0.949702626,0.944068224,0.93815334,0.931961709,0.925497241,0.91876402,0.911766299,0.904508497,0.896995199,0.889231151,0.881221256,0.872970573,0.864484314,0.855767839,0.846826653,0.837666404,0.828292878,0.818711995,0.808929807,0.798952492,0.788786352,0.778437808,0.767913397,0.757219767,0.746363671,0.735351966,0.724191608,0.712889646,0.701453218,0.689889548,0.678205939,0.666409772,0.654508497,0.642509631,0.630420753,0.618249499,0.606003555,0.593690657,0.581318583,0.568895145,0.556428192,0.543925598,0.53139526,0.518845091,0.50628302,0.49371698,0.481154909,0.46860474,0.456074402,0.443571808,0.431104855,0.418681417,0.406309343,0.393996445,0.381750501,0.369579247,0.357490369,0.345491503,0.333590228,0.321794061,0.310110452,0.298546782,0.287110354,0.275808392,0.264648034,0.253636329,0.242780233,0.232086603,0.221562192,0.211213648,0.201047508,0.191070193,0.181288005,0.171707122,0.162333596,0.153173347,0.144232161,0.135515686,0.127029427,0.118778744,0.110768849,0.103004801,0.095491503,0.088233701,0.08123598,0.074502759,0.068038291,0.06184666,0.055931776,0.050297374,0.044947015,0.039884076,0.035111757,0.030633071,0.026450848,0.022567728,0.018986164,0.015708419,0.012736564,0.010072474,0.007717833,0.005674128,0.003942649,0.002524492,0.00142055,0.000631522,0.000157905,0];
    YU=[0,3.78E-05,0.000131368,0.000264898,0.000434177,0.000641754,0.000891398,0.001193769,0.00155581,0.001980966,0.002470579,0.003024156,0.003639128,0.004310727,0.005033075,0.005800773,0.00660953,0.007455847,0.008336617,0.009249181,0.010191991,0.011165766,0.012173519,0.013217483,0.014298244,0.015416063,0.016572101,0.017767217,0.019001302,0.020273636,0.021583004,0.022928056,0.024307741,0.025721096,0.027167069,0.028644486,0.030152283,0.031689326,0.033253856,0.034842784,0.036454215,0.038086733,0.039738517,0.041406069,0.04308704,0.044779786,0.046482005,0.04818793,0.049893569,0.051596853,0.053295093,0.054981162,0.056649651,0.058298014,0.059922044,0.0615082,0.063046286,0.064532816,0.065963714,0.067328025,0.06861807,0.069831159,0.070964495,0.072011884,0.072969575,0.073836098,0.074608991,0.075282861,0.075855238,0.076325489,0.076691981,0.076951467,0.077103344,0.077148522,0.077087934,0.076922538,0.076654475,0.076287142,0.075825177,0.0752734,0.074635762,0.073915574,0.073115848,0.072239587,0.071289605,0.070268113,0.069176925,0.068018072,0.066793708,0.065505768,0.064156078,0.062746571,0.061279222,0.059755989,0.058178932,0.05655032,0.054872599,0.053148317,0.051380074,0.049570511,0.047722324,0.045838309,0.043921412,0.041974775,0.040001776,0.038006047,0.035991504,0.033962372,0.031923208,0.029878913,0.027834725,0.025796163,0.023768922,0.02175871,0.019771032,0.017810928,0.015882683,0.013989535,0.012133404,0.010314668,0.008532016,0.006782402,0.00506112,0.003361988,0.001677658,0];
    XL=[0,0.000157905,0.000631522,0.00142055,0.002524492,0.003942649,0.005674128,0.007717833,0.010072474,0.012736564,0.015708419,0.018986164,0.022567728,0.026450848,0.030633071,0.035111757,0.039884076,0.044947015,0.050297374,0.055931776,0.06184666,0.068038291,0.074502759,0.08123598,0.088233701,0.095491503,0.103004801,0.110768849,0.118778744,0.127029427,0.135515686,0.144232161,0.153173347,0.162333596,0.171707122,0.181288005,0.191070193,0.201047508,0.211213648,0.221562192,0.232086603,0.242780233,0.253636329,0.264648034,0.275808392,0.287110354,0.298546782,0.310110452,0.321794061,0.333590228,0.345491503,0.357490369,0.369579247,0.381750501,0.393996445,0.406309343,0.418681417,0.431104855,0.443571808,0.456074402,0.46860474,0.481154909,0.49371698,0.50628302,0.518845091,0.53139526,0.543925598,0.556428192,0.568895145,0.581318583,0.593690657,0.606003555,0.618249499,0.630420753,0.642509631,0.654508497,0.666409772,0.678205939,0.689889548,0.701453218,0.712889646,0.724191608,0.735351966,0.746363671,0.757219767,0.767913397,0.778437808,0.788786352,0.798952492,0.808929807,0.818711995,0.828292878,0.837666404,0.846826653,0.855767839,0.864484314,0.872970573,0.881221256,0.889231151,0.896995199,0.904508497,0.911766299,0.91876402,0.925497241,0.931961709,0.93815334,0.944068224,0.949702626,0.955052985,0.960115924,0.964888243,0.969366929,0.973549152,0.977432272,0.981013836,0.984291581,0.987263436,0.989927526,0.992282167,0.994325872,0.996057351,0.997475508,0.99857945,0.999368478,0.999842095,1];
    YL=[0,-0.00114174,-0.002283196,-0.003424034,-0.004563758,-0.005701658,-0.006836779,-0.007967902,-0.009093534,-0.010211917,-0.011321044,-0.012418693,-0.01350247,-0.014569859,-0.015618287,-0.016645185,-0.017648057,-0.018624538,-0.019572453,-0.020489857,-0.021375072,-0.022226699,-0.023043624,-0.023825006,-0.02457026,-0.025279026,-0.025951135,-0.026586571,-0.027185438,-0.027747933,-0.028274331,-0.028764997,-0.029220408,-0.029641172,-0.030028015,-0.030381684,-0.030702868,-0.030992198,-0.031250284,-0.031477674,-0.031674857,-0.031842547,-0.031981975,-0.032094466,-0.032180732,-0.032240964,-0.032275462,-0.032284651,-0.032268568,-0.032227258,-0.03216179,-0.032074241,-0.031965427,-0.031835425,-0.031684682,-0.031514648,-0.031325879,-0.03111838,-0.030891985,-0.030646219,-0.030380875,-0.030095991,-0.02979182,-0.029469535,-0.029130095,-0.028773838,-0.028400897,-0.02801007,-0.027599679,-0.027169933,-0.026721208,-0.026252753,-0.02576212,-0.025249551,-0.02471575,-0.024160786,-0.023582504,-0.022981181,-0.022357929,-0.021714356,-0.021054233,-0.020379866,-0.019692583,-0.01899374,-0.018285359,-0.017569304,-0.016846975,-0.016120235,-0.015394124,-0.014675203,-0.013965246,-0.013265228,-0.012576627,-0.011901743,-0.011241671,-0.01059706,-0.009968638,-0.009357437,-0.008764173,-0.008189175,-0.007632226,-0.007092278,-0.006568422,-0.006060402,-0.005567376,-0.005086945,-0.004616449,-0.004155519,-0.003705626,-0.003269085,-0.002848538,-0.002446922,-0.002067919,-0.001716296,-0.001397149,-0.001114271,-0.000869336,-0.000662302,-0.000491782,-0.000354907,-0.000250859,-0.000165823,-9.88E-05,-4.80E-05,-1.36E-05,0];
end

XL=flip(XL);YL=flip(YL);

[CamberLineX,CamberLineY,UpperY,LowerY]=F_Camber(XU,YU,XL,YL);

IB1=IB+1;   JB1=JB+1;CTIP=C;     S=B*(C+CTIP)/2.0;     AR=2.0*B*B/S;      BJ=0.0;
for J=1:JB1
    if J > 1
        BJ=BJ+BB(J-1);
    end
    DX1=C/IB;         % = C/IB

    % DC1=LEADING EDGE X, DC2=TRAILING EDGE X
    for I=1:IB
        QF(I,J,1)=DX1*(I-0.75)-RootX;
        QF(I,J,2)=BJ+RootY;
        if AirfoilShape ~=0
            ZZ=F_Airfoil_Coordinates(DX1*(I-0.75),C,CamberLineX,CamberLineY);
        else
            ZZ=0;
        end
        QF(I,J,3)=ZZ;
    end
    % THE FOLLOWING LINES ARE DUE TO WAKE DISTANCE FROM TRAILING EDGE
    QF(IB1,J,1)=C+DXW(J)-RootX;QF(IB1,J,2)=QF(IB,J,2);
    if AirfoilShape ~=0
        ZZB=F_Airfoil_Coordinates(DX1*(IB-0.75),C,CamberLineX,CamberLineY);
    else
        ZZ=0;
    end
    QF(IB1,J,3)=0;
end
% WING COLLOCATION POINTS

if AirfoilShape ~=0
    for J=1:JB
        Angle(J)=atan((QF(IB,J,3)-QF(IB1,J,3))/(QF(IB,J,1)-QF(IB1,J,1)));
    end
end

for J=1:JB
    BJ=QF(1,J,2)+BB(J)/2.0;
    for I=1:IB
        QC(I,J,1)=DX1*(I-0.25)-RootX;QC(I,J,2)=BJ;
        if AirfoilShape ~=0
            ZZ=F_Airfoil_Coordinates(DX1*(I-0.25),C,CamberLineX,CamberLineY);
        else
            ZZ=0;
        end
        QC(I,J,3)=ZZ;DS(I,J)=DX1*BB(J);
    end
end

if AirfoilShape ~=0
    for J=1:JB
        QC(IB,J,3)=QF(IB,J,3)-(QF(IB,J,1)-QC(IB,J,1))*tan(Angle(J));
    end
end
% ROTATION OF WING POINTS DUE TO ALFA

SN1=sin(-ALFA);CS1=cos(-ALFA);
for I=1:IB1
    for J=1:JB1
        QF1=QF(I,J,1);QF(I,J,1)=QF1*CS1-QF(I,J,3)*SN1;QF(I,J,3)=QF1*SN1+QF(I,J,3)*CS1+CH1;
        if (I~=IB1) && (J <JB1)
            QC1=QC(I,J,1);QC(I,J,1)=QC1*CS1-QC(I,J,3)*SN1;QC(I,J,3)=QC1*SN1+QC(I,J,3)*CS1+CH1;
        end
    end
end

for  J=1:JB
    for I=1:IB
        % COMPUTATION OF NORMAL VECTORS

        [SS(I,J,1),SS(I,J,2),SS(I,J,3),PanelAreas(I,J)]=F_Panel(QF(I,J,1),QF(I,J,2),QF(I,J,3),QF(I+1,J,1),QF(I+1,J,2),QF(I+1,J,3),QF(I,J+1,1),QF(I,J+1,2),QF(I,J+1,3),QF(I+1,J+1,1),QF(I+1,J+1,2),QF(I+1,J+1,3));
    end
end

for  J=1:JB
    for I=1:IB
        DotZ=0*SS(I,J,1)+0*SS(I,J,2)+1*SS(I,J,3);AbsoluteValueZ=1*sqrt(SS(I,J,1)^2+SS(I,J,2)^2+SS(I,J,3)^2);ZAngle(I,J)=DotZ/AbsoluteValueZ;
        DotX=1*SS(I,J,1)+0*SS(I,J,2)+0*SS(I,J,3);AbsoluteValueX=1*sqrt(SS(I,J,1)^2+SS(I,J,2)^2+SS(I,J,3)^2);XAngle(I,J)=DotX/AbsoluteValueX;
    end
end

for I=1:1:IB
    for J=1:1:JB
        [QCA(:,:,1), QCA(:,:,2)]=F_Rotate_1(QC(:,:,1),QC(:,:,2),180);  QCA(I,J,2)=QCA(I,J,2);  QCA(I,J,3)=QC(I,J,3);
    end
end
for I=1:1:IB1
    for J=1:1:JB1
        [QFA(:,:,1), QFA(:,:,2)]=F_Rotate_1(QF(:,:,1),QF(:,:,2),180);  QFA(I,J,2)=QFA(I,J,2);  QFA(:,:,3)=QF(:,:,3);
    end
end
end

%% Function wingl
function [U,V,W]=F_Wing_ID_Influence(X,Y,Z,GAMA,T,QF,IB,JB)

U=0.0;V=0.0;W=0.0;
for I=1:IB % 7
    for J=1:JB  % 7
        [U2,V2,W2]=F_Vortex(X,Y,Z,QF(I,J+1,1),QF(I,J+1,2),QF(I,J+1,3),QF(I+1,J+1,1),QF(I+1,J+1,2),QF(I+1,J+1,3),GAMA(I,J),T);
        [U4,V4,W4]=F_Vortex(X,Y,Z,QF(I+1,J,1),QF(I+1,J,2),QF(I+1,J,3),QF(I,J,1),QF(I,J,2),QF(I,J,3),GAMA(I,J),T);
        U=U+U2+U4;V=V+V2+V4;W=W+W2+W4;
    end
end
I=IB;
for J=1:JB
    [U3,V3,W3]=F_Vortex(X,Y,Z,QF(I+1,J+1,1),QF(I+1,J+1,2),QF(I+1,J+1,3),QF(I+1,J,1),QF(I+1,J,2),QF(I+1,J,3),GAMA(I,J),T);
    U=U+U3;V=V+V3;W=W+W3;
end
end

%% Function wingVel
function [U,V,W]=F_Wing_Influence_on_Wake(X,Y,Z,GAMA,T,IB,JB,Blade_1_QF)

U=0.0;V=0.0;W=0.0;
for I=1:IB
    for J=1:JB

        [U1,V1,W1]=F_Vortex(X,Y,Z,Blade_1_QF(I,J,1),Blade_1_QF(I,J,2),Blade_1_QF(I,J,3),Blade_1_QF(I,J+1,1),Blade_1_QF(I,J+1,2),Blade_1_QF(I,J+1,3),GAMA(I,J),T);
        [U2,V2,W2]=F_Vortex(X,Y,Z,Blade_1_QF(I,J+1,1),Blade_1_QF(I,J+1,2),Blade_1_QF(I,J+1,3),Blade_1_QF(I+1,J+1,1),Blade_1_QF(I+1,J+1,2),Blade_1_QF(I+1,J+1,3),GAMA(I,J),T);
        [U3,V3,W3]=F_Vortex(X,Y,Z,Blade_1_QF(I+1,J+1,1),Blade_1_QF(I+1,J+1,2),Blade_1_QF(I+1,J+1,3),Blade_1_QF(I+1,J,1),Blade_1_QF(I+1,J,2),Blade_1_QF(I+1,J,3),GAMA(I,J),T);
        [U4,V4,W4]=F_Vortex(X,Y,Z,Blade_1_QF(I+1,J,1),Blade_1_QF(I+1,J,2),Blade_1_QF(I+1,J,3),Blade_1_QF(I,J,1),Blade_1_QF(I,J,2),Blade_1_QF(I,J,3),GAMA(I,J),T);

        U=U+U1+U2+U3+U4;V=V+V1+V2+V3+V4;W=W+W1+W2+W3+W4;
    end
end
end
%% Function wing
function [W,A1]=F_Wing_Influence(X,Y,Z,GAMA,T,IT,IB,JB,CH,SIGN,SS,QF)
W=0.0;
for I=1:IB
    for J=1:JB

        [U1,V1,W1]=F_Vortex(X,Y,Z,QF(I,J,1),QF(I,J,2),QF(I,J,3),QF(I,J+1,1),QF(I,J+1,2),QF(I,J+1,3),GAMA(I,J),T);
        [U2,V2,W2]=F_Vortex(X,Y,Z,QF(I,J+1,1),QF(I,J+1,2),QF(I,J+1,3),QF(I+1,J+1,1),QF(I+1,J+1,2),QF(I+1,J+1,3),GAMA(I,J),T);
        [U3,V3,W3]=F_Vortex(X,Y,Z,QF(I+1,J+1,1),QF(I+1,J+1,2),QF(I+1,J+1,3),QF(I+1,J,1),QF(I+1,J,2),QF(I+1,J,3),GAMA(I,J),T);
        [U4,V4,W4]=F_Vortex(X,Y,Z,QF(I+1,J,1),QF(I+1,J,2),QF(I+1,J,3),QF(I,J,1),QF(I,J,2),QF(I,J,3),GAMA(I,J),T);

        V0=V1+V2+V3+V4;U0=U1+U2+U3+U4;W0=W1+W2+W3+W4;
        A1(I,J)=U0*SS(I,J,1)+V0*SS(I,J,2)+W0*SS(I,J,3);
        if SIGN >= 1.0
            A1(I,J)=U0*SS(I,J,1)+V0*SS(I,J,2)-W0*SS(I,J,3);
        end
        W=W+W0;
    end
end
end
%% Function wake
function [U,V,W]=F_Wake_Influence(X,Y,Z,IT,VORTIC,QW,JB,Time)
U=0;
V=0;
W=0;
I1=IT-1;
for I=1:I1
    for J=1:JB
        VORTEK=VORTIC(I,J);
        [U1,V1,W1]=F_Vortex(X,Y,Z,QW(I,J,1),QW(I,J,2),QW(I,J,3),QW(I+1,J,1),QW(I+1,J,2),QW(I+1,J,3),VORTEK,Time(I));
        [U2,V2,W2]=F_Vortex(X,Y,Z,QW(I+1,J,1),QW(I+1,J,2),QW(I+1,J,3),QW(I+1,J+1,1),QW(I+1,J+1,2),QW(I+1,J+1,3),VORTEK,Time(I));
        [U3,V3,W3]=F_Vortex(X,Y,Z,QW(I+1,J+1,1),QW(I+1,J+1,2),QW(I+1,J+1,3),QW(I,J+1,1),QW(I,J+1,2),QW(I,J+1,3),VORTEK,Time(I));
        [U4,V4,W4]=F_Vortex(X,Y,Z,QW(I,J+1,1),QW(I,J+1,2),QW(I,J+1,3),QW(I,J,1),QW(I,J,2),QW(I,J,3),VORTEK,Time(I));
        U=U+U1+U2+U3+U4;
        V=V+V1+V2+V3+V4;
        W=W+W1+W2+W3+W4;
    end
end
end
%% Function vortex
function [U,V,W]=F_Vortex(X,Y,Z,X1,Y1,Z1,X2,Y2,Z2,GAMA,T)

alf=1.25643;u=1.343*10^-5;a1=10^-4;RCUT=1.0E-10;

R1R2X=(Y-Y1)*(Z-Z2)-(Z-Z1)*(Y-Y2);R1R2Y=-((X-X1)*(Z-Z2)-(Z-Z1)*(X-X2));R1R2Z=(X-X1)*(Y-Y2)-(Y-Y1)*(X-X2);
SQUARE=R1R2X*R1R2X+R1R2Y*R1R2Y+R1R2Z*R1R2Z;R0=sqrt((X1-X2)*(X1-X2)+(Y1-Y2)*(Y1-Y2)+(Z1-Z2)*(Z1-Z2));
R1=sqrt((X-X1)*(X-X1)+(Y-Y1)*(Y-Y1)+(Z-Z1)*(Z-Z1));R2=sqrt((X-X2)*(X-X2)+(Y-Y2)*(Y-Y2)+(Z-Z2)*(Z-Z2));

if (R0<RCUT) || (R1<RCUT) || (R2<RCUT) || (SQUARE<RCUT)
    U=0.0; V=0.0;W=0.0;
else
    R0R1=(X2-X1)*(X-X1)+(Y2-Y1)*(Y-Y1)+(Z2-Z1)*(Z-Z1);R0R2=(X2-X1)*(X-X2)+(Y2-Y1)*(Y-Y2)+(Z2-Z1)*(Z-Z2);
    COEF=GAMA/(4.0*pi*SQUARE)*(R0R1/R1-R0R2/R2);RC=sqrt(4*alf*(1+a1*abs(GAMA)/u)*u*T);
    if T ==0;
        LambOseen=1;
    else
        LambOseen=(1-exp(-alf*(SQUARE/(R0*RC)^2)));
    end
    COEF=COEF*LambOseen;U=R1R2X*COEF;V=R1R2Y*COEF;W=R1R2Z*COEF;
end
end
%% Function Rotation
function [SX, SY]=F_Rotate_2(x1,y1,Azimuth)
x2=(x1)*cosd(Azimuth)-(y1)*sind(Azimuth);y2=(x1)*sind(Azimuth)+(y1)*cosd(Azimuth);
SX=x2-x1;SY=y2-y1;
end

%% Function panel
function [C1,C2,C3,S]=F_Panel(X1,Y1,Z1,X2,Y2,Z2,X3,Y3,Z3,X4,Y4,Z4)
A1=X2-X3;A2=Y2-Y3;A3=Z2-Z3;B1=X4-X1;B2=Y4-Y1;B3=Z4-Z1;
X=A2*B3-A3*B2;Y=B1*A3-A1*B3;Z=A1*B2-A2*B1;A=sqrt(X^2+Y^2+Z^2);
C1=X/A;C2=Y/A;C3=Z/A;E1=X3-X1;E2=Y3-Y1;E3=Z3-Z1;F1=X2-X1;F2=Y2-Y1;F3=Z2-Z1;
S11=F2*B3-F3*B2;S12=B1*F3-F1*B3;S13=F1*B2-F2*B1;S21=B2*E3-B3*E2;S22=E1*B3-B1*E3;S23=B1*E2-B2*E1;
S=0.5*(sqrt(S11^2+S12^2+S13^2)+sqrt(S21^2+S22^2+S23^2));
end

%% Function InitialRotation
function [x2, y2]=F_Rotate_1(x1,y1,Azimuth)
x2=(x1)*cosd(Azimuth)-(y1)*sind(Azimuth);y2=(x1)*sind(Azimuth)+(y1)*cosd(Azimuth);
end
%% Function Camber
function [CamberLineX,CamberLineY,UpperY,LowerY]=F_Camber(XU,YU,XL,YL)

I=size(XU);J=size(XL);CamberLineX=0:0.001:1;
VQ1 = interp1(XU,YU,CamberLineX,'spline','extrap');VQ2 = interp1(XL,YL,CamberLineX,'spline','extrap');
m=length(CamberLineX);VQ1(1) = 0;VQ2(1) = 0;
for i=1:1:m
    CamberLineY(i)=(VQ1(i)+VQ2(i))/2;
    UpperY(i)=VQ1(i);
    LowerY(i)=VQ2(i);
end
CamberLineY(m) = 0;
end
%% Function AnyAirfoil
function [ZZ]=F_Airfoil_Coordinates(XXX,c,CamberLineX,CamberLineY);

XXX=XXX/c;

for i=1:1:length(CamberLineX)-1

    if XXX >= CamberLineX(i) && XXX <= CamberLineX(i+1)

        Interpolation=(XXX-CamberLineX(i))/(CamberLineX(i+1)-CamberLineX(i));

        ZZ=Interpolation*(CamberLineY(i+1)-CamberLineY(i))+CamberLineY(i);
        ZZ=ZZ*c;
    elseif XXX >= CamberLineX(i+1)
        ZZ=CamberLineY(length(CamberLineX))*c;
    end
end

end
%% Function veloce
function [U,V,W]=F_Wake_Rollup(X,Y,Z,IT,QW,QWA,VORTIC,GAMA,CH,IB,JB,T,Blade_1_QF,Blade_2_QF,Wake_Age)

[U1,V1,W1]  =   F_Wake_Influence(X,Y,Z,IT,VORTIC,QW,JB,Wake_Age);
[U2,V2,W2]  =   F_Wake_Influence(X,Y,Z,IT,VORTIC,QWA,JB,Wake_Age);

U11=(U1+U2);
V11=(V1+V2);
W11=(W1+W2);

[U3,V3,W3]  = F_Wing_Influence_on_Wake(X,Y,Z,GAMA,T,IB,JB,Blade_1_QF);
[U4,V4,W4]  = F_Wing_Influence_on_Wake(X,Y,Z,GAMA,T,IB,JB,Blade_2_QF);

U33=(U3+U4);
V33=(V3+V4);
W33=(W3+W4);

% INFLUENCE OF MIRROR IMAGE
if CH <= 100.0 % GOTO 1
    [U5,V5,W5]  =   F_Wake_Influence(X,Y,-Z,IT,VORTIC,QW,JB,Wake_Age);
    [U6,V6,W6]  =   F_Wake_Influence(X,Y,-Z,IT,VORTIC,QWA,JB,Wake_Age);

    U55=(U5+U6);
    V55=(V5+V6);
    W55=W5+W6;

    [U7,V7,W7]  =   F_Wing_Influence_on_Wake(X,Y,-Z,GAMA,T,IB,JB,Blade_1_QF);
    [U8,V8,W8]  =   F_Wing_Influence_on_Wake(X,Y,-Z,GAMA,T,IB,JB,Blade_2_QF);

    U77=(U7+U8);
    V77=(V7+V8);
    W77=W7+W8;
else
    U55=0;
    V55=0;
    W55=0;
    U77=0;
    V77=0;
    W77=0;
end
% VELOCITIES MEASURED IN INERTIAL FRAME
U=U11+U33+U55+U77;
V=V11+V33+V55+V77;
W=W11+W33-W55-W77;
end
